type Query {
  user(userId: String!): UserQuery

  """you need to be authenticated to call this resolver"""
  authenticated: Boolean!
  me: UserQuery
  sendAuthMessage(pageName: String!, device: String!, time: String!, location: String!, userId: String!): Boolean!
  sendConfirmation(success: Boolean!, userId: String!): Boolean!
  webInputs(url: String!): [WebInput!]!
}

type UserQuery {
  id: String!
  email: String
  tokenVersion: Int!
  name: String
  createdAt: DateTime!
  updatedAt: DateTime
  masterDeviceId: Int
  TOTPlimit: Int!
  loginCredentialsLimit: Int!
  myDevices: [Device!]!
  devicesCount: Int!
  settings: SettingsConfig!
  encryptedSecrets: [EncryptedSecrets!]!
}

"""
The javascript `Date` as string. Type represents date and time as the ISO Date string.
"""
scalar DateTime

type Device {
  id: Int!
  firstIpAddress: String!
  lastIpAddress: String!
  firebaseToken: String!
  loginSecret: String!
  name: String!
  syncTOTP: Boolean!
  vaultLockTimeoutSeconds: Int
  createdAt: DateTime!
  updatedAt: DateTime
  registeredWithMasterAt: DateTime
  userId: String!
}

type SettingsConfig {
  userId: String!
  lockTime: Int!
  twoFA: Boolean!
  noHandsLogin: Boolean!
  homeUI: String!
  updatedAt: DateTime
}

type EncryptedSecrets {
  id: Int!
  encrypted: String!
  version: Int!
  userId: String!
  kind: EncryptedSecretsType!
  createdAt: DateTime!
  updatedAt: DateTime
}

enum EncryptedSecretsType {
  TOTP
  LOGIN_CREDENTIALS
}

type WebInput {
  id: Int!
  layoutType: String
  createdAt: DateTime!
  url: String!
  kind: WebInputType!
  domPath: String!
  addedByUserId: String!
}

enum WebInputType {
  TOTP
  USERNAME
  EMAIL
  USERNAME_OR_EMAIL
  PASSWORD
}

type Mutation {
  user(userId: String!): UserMutation

  """you need to be authenticated to call this resolver"""
  me: UserMutation
  addDevice(firebaseToken: String!, userId: String!, name: String!): Device!
  register(firebaseToken: String!, password: String!, email: String!): LoginResponse!
  login(password: String!, email: String!): LoginResponse
  logout: Boolean
  addWebInputs(webInputs: [WebInputElement!]!): [WebInput!]!
}

type UserMutation {
  id: String!
  email: String
  tokenVersion: Int!
  name: String
  createdAt: DateTime!
  updatedAt: DateTime
  masterDeviceId: Int
  TOTPlimit: Int!
  loginCredentialsLimit: Int!
  addDevice(firebaseToken: String!, name: String!): Device!
  addOTPEvent(data: OTPEvent!): Boolean!
  saveEncryptedSecrets(kind: EncryptedSecretsType!, payload: String!): EncryptedSecrets!
  updateFireToken(firebaseToken: String!): Device!
  updateSettings(noHandsLogin: Boolean!, lockTime: Int!, homeUI: String!, twoFA: Boolean!): SettingsConfig!
  revokeRefreshTokensForUser: User!
}

input OTPEvent {
  kind: String!
  url: String!
}

type User {
  id: String!
  email: String
  tokenVersion: Int!
  name: String
  createdAt: DateTime!
  updatedAt: DateTime
  masterDeviceId: Int
  TOTPlimit: Int!
  loginCredentialsLimit: Int!
}

type LoginResponse {
  accessToken: String!
  user: UserAfterAuth!
}

type UserAfterAuth {
  id: String!
  email: String
  tokenVersion: Int!
  name: String
  createdAt: DateTime!
  updatedAt: DateTime
  masterDeviceId: Int
  TOTPlimit: Int!
  loginCredentialsLimit: Int!
  EncryptedSecrets: [EncryptedSecrets!]
}

input WebInputElement {
  domPath: String!
  url: String!
  kind: WebInputType!
}
